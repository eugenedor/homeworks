USE ToolsStore
GO

SELECT * FROM dbo.FN_GET_NUM (1, 4)
GO

SELECT * FROM dbo.FN_GET_NUM (YEAR(CAST('2015-02-03' AS DATETIME)), YEAR(CAST('2019-04-04' AS DATETIME)))
GO

SELECT * FROM dbo.FN_GET_QUART (CAST('2019-04-04' AS DATETIME), DEFAULT)
GO

SELECT * FROM dbo.FN_GET_PERIOD_QUART (CAST('2015-07-03' AS DATETIME), CAST('2019-04-04' AS DATETIME))
GO

SELECT * FROM dbo.FN_GET_PERIOD_MONTH (CAST('2015-07-03' AS DATETIME), CAST('2019-04-04' AS DATETIME))
GO

SELECT q.Year, q.Quart, q.DateBegin AS DateBegin1, q.DateEnd AS DateEnd1,
       m.Month, m.DateBegin AS DateBegin2, m.DateEnd AS DateEnd2
FROM dbo.FN_GET_PERIOD_QUART (CAST('2015-07-03' AS DATETIME), CAST('2019-04-04' AS DATETIME)) q
     JOIN dbo.FN_GET_PERIOD_MONTH (CAST('2015-07-03' AS DATETIME), CAST('2019-04-04' AS DATETIME)) m
	   ON q.Year = m.Year
	      AND q.Quart = m.Quart
GO